# -Return-
Global $g_sUserProfileDir = _GetCmdLineValue("UserProfileDir", @UserProfileDir) If Not _WinAPI_IsElevated() Then     ShellExecute(@ScriptFullPath, "--UserProfileDir " &amp; $g_sUserProfileDir, "", "RunAs")     Exit EndIf  MsgBox(4096, "UserProfileDir", $g_sUserProfileDir)  Func _GetCmdLineValue($sCmdLine, $vResult = Null)     For $i = 1 To $CmdLine[0]         If $CmdLine[$i] = "/" &amp; $sCmdLine Or $CmdLine[$i] = "-" &amp; $sCmdLine Or $CmdLine[$i] = "--" &amp; $sCmdLine Then             If $CmdLine[0] >= $i + 1 Then                 If StringLeft($CmdLine[$i + 1], 1) = "/" Or StringLeft($CmdLine[$i + 1], 1) = "-" Or StringLeft($CmdLine[$i + 1], 2) = "--" Then                     Return $vResult                 Else                     Return $CmdLine[$i + 1]                 EndIf             EndIf         EndIf     Next     Return $vResult EndFunc  
